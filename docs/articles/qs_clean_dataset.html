<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quick start - Problematic datasets • CoordinateCleaner</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Quick start - Problematic datasets">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CoordinateCleaner</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">2.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Cleaning_GBIF_data_with_CoordinateCleaner.html">Tutorial - Cleaning GBIF data for the use in biogeography</a>
    </li>
    <li>
      <a href="../articles/Cleaning_PBDB_fossils_with_CoordinateCleaner.html">Tutorial - Cleaning fossil data for the use in biogeography and palaeontology</a>
    </li>
    <li>
      <a href="../articles/comparison_other_software.html">Comparison of CoordinateCleaner to other tools</a>
    </li>
    <li>
      <a href="../articles/qs_clean_coordinates.html">Quick start - Problematic records</a>
    </li>
    <li>
      <a href="../articles/qs_clean_dataset.html">Quick start - Problematic datasets</a>
    </li>
    <li>
      <a href="../articles/qs_clean_fossils.html">Quick start - Problematic fossils</a>
    </li>
    <li>
      <a href="../articles/qs_how_to_run.html">Quick start - How to run CoordinateCleaner</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Quick start - Problematic datasets</h1>
                        <h4 class="author">Alex Zizka</h4>
            
            <h4 class="date">24 July 2018</h4>
      
      
      <div class="hidden name"><code>qs_clean_dataset.Rmd</code></div>

    </div>

    
    
<div id="background" class="section level2">
<h2 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h2>
<p>Some problems with biological collection data are not apparent from individual records, but rather linked to properties of an entire data set. The CleanCoordinatesDS function can use dataset properties to flag three types of potential problems, under the assumption that these problems will effect many records in a dataset from the same source (but not necessarily all): 1. An erroneous conversion of coordinates in degree minute annotation into decimal degrees, where the decimal sign is erroneously translated into the decimal delimiter, e.g. 10°30’ to 10.3 °. This is a problem that has been observed in particular for older data sets. 2. An over representation of zero decimals, as will occur if coordinates have been rounded to integer degrees 3. A periodicity in the decimals of a data set, as will arise when coordinates are either rounded or recorded in a raster format and coordinates represent raster cell centers.</p>
<p>Numbers 2 and 3 represent low precision rather than errors, but can also be fatal, if undetected and taken as actual localities, for example in distribution modelling.</p>
<p><strong><em>Please find a detailed tutorial on how to clean occurrence records (e.g. from GBIF) <a href="https://azizka.github.io/CoordinateCleaner/articles/Cleaning_GBIF_data_with_CoordinateCleaner.html">here</a> and how to clean fossil data (e.g. from PBDB) <a href="https://azizka.github.io/CoordinateCleaner/articles/Cleaning_PBDB_fossils_with_CoordinateCleaner.html">here</a>.</em></strong></p>
</div>
<div id="running-clean_dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#running-clean_dataset" class="anchor"></a>Running <code>clean_dataset</code>
</h2>
<p>The <code>clean_dataset</code> function implements tests to identify these problems on a data set level. A data set can in this context can be any meaningful cluster of occurrence records, i.e from the same museum, or the same collector, etc. Output is a summary data.frame with summarizing flags for each test and dataset (note that you can change the level of detail in the output with the <code>output</code> flag). We generally recommend to double check the results, in particular of the periodicity test. IN general power of the test increases with data set size and geographic extent. The test can be made more conservative using the <code>periodicity.thresh</code> argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(CoordinateCleaner)
## Registered S3 methods overwritten by 'ggplot2':
##   method         from 
##   [.quosures     rlang
##   c.quosures     rlang
##   print.quosures rlang
## Registered S3 method overwritten by 'dplyr':
##   method               from  
##   as.data.frame.tbl_df tibble

<span class="co">#Create test dataset</span>
clean &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">dataset =</span> <span class="kw">rep</span>(<span class="st">"clean"</span>, <span class="dv">1000</span>),
                    <span class="dt">decimallongitude =</span> <span class="kw">runif</span>(<span class="dt">min =</span> <span class="op">-</span><span class="dv">42</span>, <span class="dt">max =</span> <span class="op">-</span><span class="dv">40</span>, <span class="dt">n =</span> <span class="dv">1000</span>),
                    <span class="dt">decimallatitude =</span> <span class="kw">runif</span>(<span class="dt">min =</span> <span class="op">-</span><span class="dv">12</span>, <span class="dt">max =</span> <span class="op">-</span><span class="dv">10</span>, <span class="dt">n =</span> <span class="dv">1000</span>))
                    
bias.long &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">round</span>(<span class="kw">runif</span>(<span class="dt">min =</span> <span class="op">-</span><span class="dv">42</span>, <span class="dt">max =</span> <span class="op">-</span><span class="dv">40</span>, <span class="dt">n =</span> <span class="dv">500</span>), <span class="dv">1</span>),
               <span class="kw">round</span>(<span class="kw">runif</span>(<span class="dt">min =</span> <span class="op">-</span><span class="dv">42</span>, <span class="dt">max =</span> <span class="op">-</span><span class="dv">40</span>, <span class="dt">n =</span> <span class="dv">300</span>), <span class="dv">0</span>),
               <span class="kw">runif</span>(<span class="dt">min =</span> <span class="op">-</span><span class="dv">42</span>, <span class="dt">max =</span> <span class="op">-</span><span class="dv">40</span>, <span class="dt">n =</span> <span class="dv">200</span>))
bias.lat &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">round</span>(<span class="kw">runif</span>(<span class="dt">min =</span> <span class="op">-</span><span class="dv">12</span>, <span class="dt">max =</span> <span class="op">-</span><span class="dv">10</span>, <span class="dt">n =</span> <span class="dv">500</span>), <span class="dv">1</span>),
              <span class="kw">round</span>(<span class="kw">runif</span>(<span class="dt">min =</span> <span class="op">-</span><span class="dv">12</span>, <span class="dt">max =</span> <span class="op">-</span><span class="dv">10</span>, <span class="dt">n =</span> <span class="dv">300</span>), <span class="dv">0</span>),
              <span class="kw">runif</span>(<span class="dt">min =</span> <span class="op">-</span><span class="dv">12</span>, <span class="dt">max =</span> <span class="op">-</span><span class="dv">10</span>, <span class="dt">n =</span> <span class="dv">200</span>))
bias &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">dataset =</span> <span class="kw">rep</span>(<span class="st">"biased"</span>, <span class="dv">1000</span>),
                   <span class="dt">decimallongitude =</span> bias.long,
                   <span class="dt">decimallatitude =</span> bias.lat)
test &lt;-<span class="st"> </span><span class="kw">rbind</span>(clean, bias)

<span class="co">#run clean_dataset</span>
flags &lt;-<span class="st"> </span><span class="kw"><a href="../reference/clean_dataset.html">clean_dataset</a></span>(test)
## Testing for dd.mm to dd.dd conversion errors
## Warning in FUN(X[[i]], ...): Geographic span too small, check 'min_span'
## Flagged 0 records
## Testing for rasterized collection</code></pre></div>
<p><img src="qs_clean_dataset_files/figure-html/unnamed-chunk-1-1.png" width="700"><img src="qs_clean_dataset_files/figure-html/unnamed-chunk-1-2.png" width="700"><img src="qs_clean_dataset_files/figure-html/unnamed-chunk-1-3.png" width="700"><img src="qs_clean_dataset_files/figure-html/unnamed-chunk-1-4.png" width="700"><img src="qs_clean_dataset_files/figure-html/unnamed-chunk-1-5.png" width="700"><img src="qs_clean_dataset_files/figure-html/unnamed-chunk-1-6.png" width="700"><img src="qs_clean_dataset_files/figure-html/unnamed-chunk-1-7.png" width="700"></p>
<pre><code>## Flagged 1 datasets.</code></pre>
<p><img src="qs_clean_dataset_files/figure-html/unnamed-chunk-1-8.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co">#check problems</span>
<span class="co">#clean</span>
<span class="kw">hist</span>(test[test<span class="op">$</span>dataset <span class="op">==</span><span class="st"> </span><span class="kw">rownames</span>(flags[flags<span class="op">$</span>summary,]), <span class="st">"decimallongitude"</span>])</code></pre></div>
<p><img src="qs_clean_dataset_files/figure-html/unnamed-chunk-1-9.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#biased</span>
<span class="kw">hist</span>(test[test<span class="op">$</span>dataset <span class="op">==</span><span class="st"> </span><span class="kw">rownames</span>(flags[<span class="op">!</span>flags<span class="op">$</span>summary,]), <span class="st">"decimallongitude"</span>])</code></pre></div>
<p><img src="qs_clean_dataset_files/figure-html/unnamed-chunk-1-10.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#background">Background</a></li>
      <li><a href="#running-clean_dataset">Running <code>clean_dataset</code></a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Alexander Zizka.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
